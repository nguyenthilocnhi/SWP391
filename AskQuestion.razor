@page "/dat-cau-hoi"
@inject HttpClient Http

<link rel="stylesheet" href="css/datcauhoi.css" />

<h1>ĐẶT CÂU HỎI</h1>
<p class="subtitle">Bạn có thể đặt câu hỏi ẩn danh về sức khỏe, giới tính, tâm lý...</p>

<div class="form-container">
    <input placeholder="Tên của bạn (hoặc ẩn danh)" @bind="Sender" />
    <select @bind="Topic">
        <option disabled selected>Chọn chủ đề câu hỏi</option>
        <option>Sức khỏe</option>
        <option>Tâm lý</option>
        <option>Giới tính</option>
        <option>Khác</option>
    </select>
    <textarea placeholder="Nhập câu hỏi của bạn..." @bind="Content"></textarea>
    <button @onclick="SubmitQuestion">Gửi câu hỏi</button>

    @if (IsSubmitted)
    {
        <p class="text-success">✅ Câu hỏi đã được gửi thành công!</p>
    }
</div>

@code {
    private string Sender = "";
    private string Topic = "";
    private string Content = "";
    private bool IsSubmitted = false;

    private async Task SubmitQuestion()
    {
        var question = new
        {
            Sender = string.IsNullOrWhiteSpace(Sender) ? "Ẩn danh" : Sender,
            Topic,
            Content
        };

       var response = await Http.PostAsJsonAsync("https://localhost:5081/api/Questions", question);
        if (response.IsSuccessStatusCode)
        {
            IsSubmitted = true;
            Sender = "";
            Topic = "";
            Content = "";
        }
    }
}
