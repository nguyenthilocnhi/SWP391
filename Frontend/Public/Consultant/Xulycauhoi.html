<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>X·ª≠ L√Ω C√¢u H·ªèi</title>
  <link rel="stylesheet" href="/Frontend/assets/css/Consultant_answer.css" />
</head>
<body>
  <div class="dashboard">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="user-info">
        <img src="https://i.postimg.cc/rFsJ2wWR/tuvanvien.jpg" class="avatar" alt="Avatar">
        <div class="name" id="consultantName">T∆∞ v·∫•n vi√™n A</div>
      </div>
      <nav class="menu">
        <a href="Home.html">üè† Trang ch·ªß</a>
        <a href="Hosotuvanvien.html">üìù H·ªì s∆°</a>
        <a href="Lichlamviec.html">üìÖ L·ªãch</a>
        <a href="Lichhen.html">üìñ H·∫πn</a>
        <a href="Xemdanhgia.html">‚≠ê ƒê√°nh gi√°</a>
        <a href="Hoidap.html" class="active">üí¨ H·ªèi ƒë√°p</a>
      </nav>
      <div class="bottom-links">
        <a href="#">‚ùì H·ªó tr·ª£</a>
        <a href="#">‚öôÔ∏è C√†i ƒë·∫∑t</a>
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <header class="topbar">
        <img src="https://i.postimg.cc/g2C1ys2D/nh-ch-p-m-n-h-nh-2025-06-29-000958.png" alt="An Gi·ªõi" class="logo" />
        <input type="text" class="search" placeholder="T√¨m ki·∫øm c√¢u h·ªèi..." />
      </header>

      <div class="container">
        <h2>X·ª≠ l√Ω c√¢u h·ªèi kh√°ch h√†ng</h2>

        <div class="question-box" id="questionBox">
          <p><strong>Kh√°ch h√†ng:</strong> <span id="qCustomer"></span></p>
          <p><strong>Email:</strong> <span id="qEmail"></span></p>
          <p><strong>Th·ªùi gian g·ª≠i:</strong> <span id="qTime"></span></p>
          <p><strong>C√¢u h·ªèi:</strong><br><span id="qContent"></span></p>
        </div>

        <form class="answer-form" id="answerForm">
          <label for="answer">Tr·∫£ l·ªùi:</label>
          <textarea id="answer" placeholder="Nh·∫≠p n·ªôi dung tr·∫£ l·ªùi..." required></textarea>
          <button type="submit">G·ª≠i ph·∫£n h·ªìi</button>
        </form>

        <div class="success-msg" id="successMsg">‚úÖ Tr·∫£ l·ªùi ƒë√£ ƒë∆∞·ª£c g·ª≠i!</div>
      </div>
    </main>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const urlParams = new URLSearchParams(window.location.search);
      const questionId = urlParams.get("id");

      const questions = JSON.parse(localStorage.getItem("questions")) || [];
      const index = questions.findIndex(q => q.id === questionId);
      if (index === -1) {
        document.getElementById("questionBox").innerHTML = "<p>Kh√¥ng t√¨m th·∫•y c√¢u h·ªèi.</p>";
        document.getElementById("answerForm").style.display = "none";
        return;
      }

      const q = questions[index];
      document.getElementById("qCustomer").textContent = q.customer;
      document.getElementById("qEmail").textContent = q.email;
      document.getElementById("qTime").textContent = q.time;
      document.getElementById("qContent").textContent = q.content || q.question;

      // N·∫øu ƒë√£ tr·∫£ l·ªùi th√¨ hi·ªán ra n·ªôi dung c≈©
      if (q.status === "answered" && q.answer) {
        document.getElementById("answer").value = q.answer;
      }

      // G·ª≠i ph·∫£n h·ªìi
      document.getElementById("answerForm").addEventListener("submit", function (e) {
        e.preventDefault();
        const content = document.getElementById("answer").value.trim();
        if (content === "") {
          alert("Vui l√≤ng nh·∫≠p n·ªôi dung tr·∫£ l·ªùi.");
          return;
        }

        questions[index].answer = content;
        questions[index].status = "answered";
        localStorage.setItem("questions", JSON.stringify(questions));

        document.getElementById("successMsg").style.display = "block";
        document.getElementById("successMsg").scrollIntoView({ behavior: 'smooth' });
      });
    });
  </script>
</body>
</html>
